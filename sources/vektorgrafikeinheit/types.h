/*
 *
 * Author:   Thorsten Knoll
 * Date:     09/26/2016
 *
 * GPLv3-Copyright:
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

#include <stdbool.h>

typedef struct point {
	int xyz[3];
} Point;

typedef struct vector {
	int xyz[3];
} Vector;

typedef struct surface {
	Point points[4];
} Surface;

typedef struct obj_l {
	Point points[8];
	Point middle;
} Obj_l;

typedef struct obj_s {
	Surface surfaces[6];
	Vector normals[6];
} Obj_s;

typedef struct obj_p {
	Surface surfaces[6];
	bool visible[6];
} Obj_p;

static const float sin_table[256] = {
		0.0,
		0.02464,
		0.04926,
		0.07385,
		0.0984,
		0.12289,
		0.1473,
		0.17163,
		0.19585,
		0.21995,
		0.24391,
		0.26773,
		0.29139,
		0.31487,
		0.33816,
		0.36124,
		0.38411,
		0.40674,
		0.42912,
		0.45124,
		0.47309,
		0.49466,
		0.51592,
		0.53687,
		0.55749,
		0.57777,
		0.59771,
		0.61728,
		0.63647,
		0.65528,
		0.6737,
		0.6917,
		0.70928,
		0.72643,
		0.74314,
		0.7594,
		0.7752,
		0.79053,
		0.80538,
		0.81974,
		0.8336,
		0.84696,
		0.8598,
		0.87212,
		0.88391,
		0.89516,
		0.90587,
		0.91603,
		0.92564,
		0.93468,
		0.94315,
		0.95106,
		0.95838,
		0.96512,
		0.97128,
		0.97685,
		0.98182,
		0.9862,
		0.98998,
		0.99316,
		0.99573,
		0.99771,
		0.99907,
		0.99983,
		0.99998,
		0.99953,
		0.99846,
		0.9968,
		0.99452,
		0.99164,
		0.98817,
		0.98409,
		0.97941,
		0.97414,
		0.96828,
		0.96183,
		0.95479,
		0.94718,
		0.93899,
		0.93023,
		0.92091,
		0.91102,
		0.90059,
		0.8896,
		0.87808,
		0.86603,
		0.85344,
		0.84034,
		0.82673,
		0.81262,
		0.79802,
		0.78293,
		0.76736,
		0.75133,
		0.73484,
		0.71791,
		0.70054,
		0.68275,
		0.66454,
		0.64593,
		0.62692,
		0.60754,
		0.58779,
		0.56767,
		0.54722,
		0.52643,
		0.50533,
		0.48391,
		0.4622,
		0.44022,
		0.41796,
		0.39545,
		0.3727,
		0.34973,
		0.32654,
		0.30315,
		0.27958,
		0.25584,
		0.23195,
		0.20791,
		0.18375,
		0.15948,
		0.13511,
		0.11065,
		0.08613,
		0.06156,
		0.03695,
		0.01232,
		-0.01232,
		-0.03695,
		-0.06156,
		-0.08613,
		-0.11065,
		-0.13511,
		-0.15948,
		-0.18375,
		-0.20791,
		-0.23195,
		-0.25584,
		-0.27958,
		-0.30315,
		-0.32654,
		-0.34973,
		-0.3727,
		-0.39545,
		-0.41796,
		-0.44022,
		-0.4622,
		-0.48391,
		-0.50533,
		-0.52643,
		-0.54722,
		-0.56767,
		-0.58779,
		-0.60754,
		-0.62692,
		-0.64593,
		-0.66454,
		-0.68275,
		-0.70054,
		-0.71791,
		-0.73484,
		-0.75133,
		-0.76736,
		-0.78293,
		-0.79802,
		-0.81262,
		-0.82673,
		-0.84034,
		-0.85344,
		-0.86603,
		-0.87808,
		-0.8896,
		-0.90059,
		-0.91102,
		-0.92091,
		-0.93023,
		-0.93899,
		-0.94718,
		-0.95479,
		-0.96183,
		-0.96828,
		-0.97414,
		-0.97941,
		-0.98409,
		-0.98817,
		-0.99164,
		-0.99452,
		-0.9968,
		-0.99846,
		-0.99953,
		-0.99998,
		-0.99983,
		-0.99907,
		-0.99771,
		-0.99573,
		-0.99316,
		-0.98998,
		-0.9862,
		-0.98182,
		-0.97685,
		-0.97128,
		-0.96512,
		-0.95838,
		-0.95106,
		-0.94315,
		-0.93468,
		-0.92564,
		-0.91603,
		-0.90587,
		-0.89516,
		-0.88391,
		-0.87212,
		-0.8598,
		-0.84696,
		-0.8336,
		-0.81974,
		-0.80538,
		-0.79053,
		-0.7752,
		-0.7594,
		-0.74314,
		-0.72643,
		-0.70928,
		-0.6917,
		-0.6737,
		-0.65528,
		-0.63647,
		-0.61728,
		-0.59771,
		-0.57777,
		-0.55749,
		-0.53687,
		-0.51592,
		-0.49466,
		-0.47309,
		-0.45124,
		-0.42912,
		-0.40674,
		-0.38411,
		-0.36124,
		-0.33816,
		-0.31487,
		-0.29139,
		-0.26773,
		-0.24391,
		-0.21995,
		-0.19585,
		-0.17163,
		-0.1473,
		-0.12289,
		-0.0984,
		-0.07385,
		-0.04926,
		-0.02464,
		-0.0 };

static const float cos_table[256] = {
		1.0,
		0.9997,
		0.99879,
		0.99727,
		0.99515,
		0.99242,
		0.98909,
		0.98516,
		0.98063,
		0.97551,
		0.9698,
		0.96349,
		0.9566,
		0.94913,
		0.94109,
		0.93247,
		0.92329,
		0.91355,
		0.90325,
		0.8924,
		0.88101,
		0.86909,
		0.85664,
		0.84367,
		0.83018,
		0.8162,
		0.80171,
		0.78674,
		0.7713,
		0.75538,
		0.73901,
		0.72219,
		0.70493,
		0.68724,
		0.66913,
		0.65062,
		0.63171,
		0.61242,
		0.59276,
		0.57274,
		0.55236,
		0.53166,
		0.51063,
		0.48929,
		0.46766,
		0.44574,
		0.42355,
		0.4011,
		0.37841,
		0.35549,
		0.33235,
		0.30902,
		0.28549,
		0.26179,
		0.23794,
		0.21393,
		0.1898,
		0.16555,
		0.14121,
		0.11677,
		0.09227,
		0.06771,
		0.04311,
		0.01848,
		-0.00616,
		-0.0308,
		-0.05541,
		-0.07999,
		-0.10453,
		-0.129,
		-0.15339,
		-0.17769,
		-0.20188,
		-0.22595,
		-0.24988,
		-0.27366,
		-0.29728,
		-0.32071,
		-0.34395,
		-0.36698,
		-0.38979,
		-0.41236,
		-0.43468,
		-0.45673,
		-0.47851,
		-0.5,
		-0.52118,
		-0.54205,
		-0.56259,
		-0.58279,
		-0.60263,
		-0.62211,
		-0.64121,
		-0.65992,
		-0.67824,
		-0.69613,
		-0.71361,
		-0.73065,
		-0.74725,
		-0.7634,
		-0.77908,
		-0.79429,
		-0.80902,
		-0.82325,
		-0.83699,
		-0.85022,
		-0.86293,
		-0.87512,
		-0.88677,
		-0.89789,
		-0.90847,
		-0.91849,
		-0.92795,
		-0.93685,
		-0.94518,
		-0.95294,
		-0.96012,
		-0.96672,
		-0.97273,
		-0.97815,
		-0.98297,
		-0.9872,
		-0.99083,
		-0.99386,
		-0.99628,
		-0.9981,
		-0.99932,
		-0.99992,
		-0.99992,
		-0.99932,
		-0.9981,
		-0.99628,
		-0.99386,
		-0.99083,
		-0.9872,
		-0.98297,
		-0.97815,
		-0.97273,
		-0.96672,
		-0.96012,
		-0.95294,
		-0.94518,
		-0.93685,
		-0.92795,
		-0.91849,
		-0.90847,
		-0.89789,
		-0.88677,
		-0.87512,
		-0.86293,
		-0.85022,
		-0.83699,
		-0.82325,
		-0.80902,
		-0.79429,
		-0.77908,
		-0.7634,
		-0.74725,
		-0.73065,
		-0.71361,
		-0.69613,
		-0.67824,
		-0.65992,
		-0.64121,
		-0.62211,
		-0.60263,
		-0.58279,
		-0.56259,
		-0.54205,
		-0.52118,
		-0.5,
		-0.47851,
		-0.45673,
		-0.43468,
		-0.41236,
		-0.38979,
		-0.36698,
		-0.34395,
		-0.32071,
		-0.29728,
		-0.27366,
		-0.24988,
		-0.22595,
		-0.20188,
		-0.17769,
		-0.15339,
		-0.129,
		-0.10453,
		-0.07999,
		-0.05541,
		-0.0308,
		-0.00616,
		0.01848,
		0.04311,
		0.06771,
		0.09227,
		0.11677,
		0.14121,
		0.16555,
		0.1898,
		0.21393,
		0.23794,
		0.26179,
		0.28549,
		0.30902,
		0.33235,
		0.35549,
		0.37841,
		0.4011,
		0.42355,
		0.44574,
		0.46766,
		0.48929,
		0.51063,
		0.53166,
		0.55236,
		0.57274,
		0.59276,
		0.61242,
		0.63171,
		0.65062,
		0.66913,
		0.68724,
		0.70493,
		0.72219,
		0.73901,
		0.75538,
		0.7713,
		0.78674,
		0.80171,
		0.8162,
		0.83018,
		0.84367,
		0.85664,
		0.86909,
		0.88101,
		0.8924,
		0.90325,
		0.91355,
		0.92329,
		0.93247,
		0.94109,
		0.94913,
		0.9566,
		0.96349,
		0.9698,
		0.97551,
		0.98063,
		0.98516,
		0.98909,
		0.99242,
		0.99515,
		0.99727,
		0.99879,
		0.9997,
		1.0 };
